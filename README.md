# Continual One-Class Malware Detection

This repository contains the code and data for the paper "Continual One-Class Malware Detection" proposed for the **... confrence on Lifelong Learning Agents**.

## Datasets
### CIC-MalMem-2022
This dataset is designed to test obfuscated malware detection methods through memory. The dataset was created to represent real-world malware types including Spyware, Ransomware, and Trojan Horse. 
Debug mode was used for the memory dump process to reproduce typical use cases of users with applications in execution when malware attacks occur.
The dataset contains a total of 58,596 instances (29,298 benign, 29,298 malicious).

### CIC-Evasive-PDFMal2022
PDF is the most widely used document format due to its portability and reliability. Unfortunately, its popularity and advanced features have allowed attackers to misuse them to deliver a malicious payload.
Authors collected a large number of malicious files from Contagio and VirusTotal and extracted 32 representative features, including 12 general  and 25 structural. After processing, this dataset consists of 10,025 instances (4468 benign, 5557 malicious).

### CIC-AndMal-2017
Android malware detection is becoming increasingly challenging for cybersecurity experts, due to the large number of variants released every day.
This dataset includes 10,854 samples (4,354 malware and 6,500 benign) from several sources. Benign data is collected from the Google Play market.
5,000 of the collected apps (426 malware and 5,065 benign) were installed on real devices. Malware samples are classified into four categories: Adware, Ransomware, Scareware, SMS Malware.

## To Run The Experiments
The experiments for this dataset are run in two files to cut down on total processing time. 
### Save File Creator
Formatting and normalization of the datasets takes place in the Save File creator. First run the import and functions cells. Since each dataset has a slightly different initial format they are each handled in their own cell which cleans the data by removing
bad lines as well as splitting it into train and test sets. Once one (but no more than one) of the dataset import cells has been run, users can "Create the saves". This ballances each class so that each class has an equal number of benign and attack points.
It then symmetrically shuffles each class and saves the entire dataset as two matched pickle files, attack and benign. They follow the naming convention: "set[set_num].pickle" for attacks or "benign[set_num].pickle"

### Experiments Runner
This is the bulk of our methodology and allows users to run the experimental pipeline. It is largely self sufficient but there are a number of options to chose from. 
- Simply run every cell that initilizes a function, they are all nessessaray for the correct execution of the experiments.
Under Importing save files, the paths are specific to our file structure, but it is highly recommended to keep the variable "dataset_name" as it is used later in the code.
- Run the Data Processing cell.
- **WORK IN PROGRESS** No Clustering is an option specifically for the CIC-MalMem-2022 dataset as its format is not conducive to our method of clustering association.
- Under Clustering, the user selects how many clusters they want in their dataset, and how many classes they have in their dataset.
- Under Cluster Association the user choses which algorithm they would like for cluster association:
  - random_assignment (scenario C in the paper)
  - mostest_closest (scenario A in the paper)
- The user then choses the refresh percent to be used for Experience Replay (Random) and Experience Replay RS (Selective) . In this same cell there are options for naming and file paths.
- Each learning model is given its own cell, and the only option is which learning scenario is run. Heatmaps are created and saved during this step. **experience_replay_rs is the novel scenario that we propose in this paper**
  - naive_scenario
  - cumulative_scenario
  - experience_replay
  - experience_replay_rs
- Finally, the user runs the last cell which saves the results.
